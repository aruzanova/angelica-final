[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Summary",
    "section": "",
    "text": "This analysis draws on two datasets from the Texas Commission on Environmental Quality (TCEQ), accessed through the Texas Open Data Portal and linked via investigation numbers unique to each cited entity.\nThe Notices of Violation (NOVs) Dataset includes records of notices handed out to entities that haven’t complied with environmental regulations since 2010. The Violation Citations Dataset offers detailed insights into individual violations, including their categories, allegations, resolutions, and other relevant details, with records going as far bar as 1998.\n\n\nThe Port Arthur Refinery leads ** since 2010 with 943 notices, according to TCEQ data. Allegations against the nation’s second-largest petroleum and crude oil refinery include delayed hazardous spill cleanups, open waste containers, and failure to prevent unauthorized atmospheric emissions.\nIn Harris County, home to the highest number of violations overall (28,179), the Chevron Phillips chemical plant leads with 545 citations, followed by ExxonMobil’s Baytown refinery with 389 notices since 2010.\n\n\n\nIn Greater Austin, trends fluctuate. Environmental violations in regional counties peaked in 2019 with 770 notices, according to TCEQ data, paralleling the statewide surge. Possible factors contributing to the increase include the amendment of the Texas Water Code outlined in the agency’s Biennial Report and intensified enforcement efforts which resulted in more than $2.7 million allocated for Supplemental Environmental Projects.\nViolations declined during the COVID-19 pandemic but spiked again in 2023 with 595 notices within the region.\n\n\n\n\n\nRetail businesses, including gas stations, lead Texas industries in environmental violations with 12,522 notices since 2010, according to TCEQ data. Petroleum and chemical manufacturing follows closely, accounting for 8,325 violations during the same period.\nThe City of Pflugerville leads Travis County in environmental violations with 54 notices, including a 2019 citation for failing to remove cryptosporidium, a fecal parasite that poses public health risks, from its water supply.\nWalnut Creek’s wastewater treatment plant follows with 28 notices, including citations for deteriorating infrastructure and visible foam discharges in November 2022, according to TCEQ records.\nA Chevron Phillips chemical plant in Harris County, Texas - home to the state’s highest number of environmental violations - leads the number of environmental citations in the county. Its Cedar Bayou facility has received 545 notices, including violations for failing to detect a rail car leak and prevent unauthorized emissions.\nAn ExxonMobil refinery in Baytown comes second with 389 violation citations, example of which include exceeding the hydrogen sulfide and nitrogen oxide emissions within the daily cap.\nAlthough recommendations vary, corrective actions for companies such as Motiva and Marathon Petroleum include adjusting operational procedures for the equipment and training personnel. Such resolutions typically follow.\nMidland County has the highest number of Category A violations in Texas, which require automatic enforcement actions.\nCategory B violations, which require corrective action by a deadline, are the most common, with 154,745 total notices since 1998 - nearly double those in Categories A and C combined.\nThe most frequent citation is a “failure to meet the limit for one or more permit parameters,” recorded 61,607 times since 1998. Other violations include failing to report breaches during monitoring periods and noncompliance with wastewater discharge limits.\n\n\n\n\nThese datasets were cross-referenced to gain a comprehensive idea of the different descriptions and attributions in the violation records. Although the Violation Citations dataset spans back to 1998, it shows incompleteness of earlier years. The NOV dataset begins in 2010 but contains an inconsiderable amount of invalid years (see line 109 in Cleaning).\nAdditionally, the data only includes violations formally documented by TCEQ and does not capture potential unreported incidents.\nA country with good, fair, and reliable institutions is country that thrives (this isn’t filler words, just honest thoughts). Therefore, a regular analysis of data which sheds light on public health and environmental concerns in local communities is not only necessary, but empowering, holding high-stakes institutions accountable for their actions."
  },
  {
    "objectID": "index.html#reporting-with-data-environmental-violations-in-the-lone-star-state",
    "href": "index.html#reporting-with-data-environmental-violations-in-the-lone-star-state",
    "title": "Summary",
    "section": "",
    "text": "This analysis draws on two datasets from the Texas Commission on Environmental Quality (TCEQ), accessed through the Texas Open Data Portal and linked via investigation numbers unique to each cited entity.\nThe Notices of Violation (NOVs) Dataset includes records of notices handed out to entities that haven’t complied with environmental regulations since 2010. The Violation Citations Dataset offers detailed insights into individual violations, including their categories, allegations, resolutions, and other relevant details, with records going as far bar as 1998.\n\n\nThe Port Arthur Refinery leads ** since 2010 with 943 notices, according to TCEQ data. Allegations against the nation’s second-largest petroleum and crude oil refinery include delayed hazardous spill cleanups, open waste containers, and failure to prevent unauthorized atmospheric emissions.\nIn Harris County, home to the highest number of violations overall (28,179), the Chevron Phillips chemical plant leads with 545 citations, followed by ExxonMobil’s Baytown refinery with 389 notices since 2010.\n\n\n\nIn Greater Austin, trends fluctuate. Environmental violations in regional counties peaked in 2019 with 770 notices, according to TCEQ data, paralleling the statewide surge. Possible factors contributing to the increase include the amendment of the Texas Water Code outlined in the agency’s Biennial Report and intensified enforcement efforts which resulted in more than $2.7 million allocated for Supplemental Environmental Projects.\nViolations declined during the COVID-19 pandemic but spiked again in 2023 with 595 notices within the region.\n\n\n\n\n\nRetail businesses, including gas stations, lead Texas industries in environmental violations with 12,522 notices since 2010, according to TCEQ data. Petroleum and chemical manufacturing follows closely, accounting for 8,325 violations during the same period.\nThe City of Pflugerville leads Travis County in environmental violations with 54 notices, including a 2019 citation for failing to remove cryptosporidium, a fecal parasite that poses public health risks, from its water supply.\nWalnut Creek’s wastewater treatment plant follows with 28 notices, including citations for deteriorating infrastructure and visible foam discharges in November 2022, according to TCEQ records.\nA Chevron Phillips chemical plant in Harris County, Texas - home to the state’s highest number of environmental violations - leads the number of environmental citations in the county. Its Cedar Bayou facility has received 545 notices, including violations for failing to detect a rail car leak and prevent unauthorized emissions.\nAn ExxonMobil refinery in Baytown comes second with 389 violation citations, example of which include exceeding the hydrogen sulfide and nitrogen oxide emissions within the daily cap.\nAlthough recommendations vary, corrective actions for companies such as Motiva and Marathon Petroleum include adjusting operational procedures for the equipment and training personnel. Such resolutions typically follow.\nMidland County has the highest number of Category A violations in Texas, which require automatic enforcement actions.\nCategory B violations, which require corrective action by a deadline, are the most common, with 154,745 total notices since 1998 - nearly double those in Categories A and C combined.\nThe most frequent citation is a “failure to meet the limit for one or more permit parameters,” recorded 61,607 times since 1998. Other violations include failing to report breaches during monitoring periods and noncompliance with wastewater discharge limits.\n\n\n\n\nThese datasets were cross-referenced to gain a comprehensive idea of the different descriptions and attributions in the violation records. Although the Violation Citations dataset spans back to 1998, it shows incompleteness of earlier years. The NOV dataset begins in 2010 but contains an inconsiderable amount of invalid years (see line 109 in Cleaning).\nAdditionally, the data only includes violations formally documented by TCEQ and does not capture potential unreported incidents.\nA country with good, fair, and reliable institutions is country that thrives (this isn’t filler words, just honest thoughts). Therefore, a regular analysis of data which sheds light on public health and environmental concerns in local communities is not only necessary, but empowering, holding high-stakes institutions accountable for their actions."
  },
  {
    "objectID": "02-analysis.html",
    "href": "02-analysis.html",
    "title": "Analysis",
    "section": "",
    "text": "This project aims to analyze environmental quality violations from the Texas Commission on Environmental Quality available publicly on Texas Open Data Portal. The goal is to understand which businesses in Texas get cited for environmental quality concerns, as well as when and where these violations occur.\nI will explore the following trends:\n\nWhich entities/businesses received the highest number of environmental violations in Texas? Who stands out in Travis County?\nWhich Texas county is home to the businesses responsible for the majority of environmental citations since 1998?\nWho received the most violations in Harris County - the top emitter?\nHow have violation trends evolved since 2010, and what factors might explain their increase or decrease?\nDo the yearly trends differ in Greater Austin? If so, how?\nWhat are category A, B, and C violations, and what is their composition in the data?\nWhich entity has the most category A violations, and what are they?\nWhich industry receives the most environmental quality notices, and what specific issues are cited?"
  },
  {
    "objectID": "02-analysis.html#goals-of-this-notebook",
    "href": "02-analysis.html#goals-of-this-notebook",
    "title": "Analysis",
    "section": "",
    "text": "This project aims to analyze environmental quality violations from the Texas Commission on Environmental Quality available publicly on Texas Open Data Portal. The goal is to understand which businesses in Texas get cited for environmental quality concerns, as well as when and where these violations occur.\nI will explore the following trends:\n\nWhich entities/businesses received the highest number of environmental violations in Texas? Who stands out in Travis County?\nWhich Texas county is home to the businesses responsible for the majority of environmental citations since 1998?\nWho received the most violations in Harris County - the top emitter?\nHow have violation trends evolved since 2010, and what factors might explain their increase or decrease?\nDo the yearly trends differ in Greater Austin? If so, how?\nWhat are category A, B, and C violations, and what is their composition in the data?\nWhich entity has the most category A violations, and what are they?\nWhich industry receives the most environmental quality notices, and what specific issues are cited?"
  },
  {
    "objectID": "02-analysis.html#set-up-import",
    "href": "02-analysis.html#set-up-import",
    "title": "Analysis",
    "section": "Set up & import",
    "text": "Set up & import\nTo accomplish my tasks, I am loading in a couple of handy packages.\n\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(stringr)\nlibrary(dplyr)\n\nThis is also where I will import my cleaned data sets: nov_clean, which gives me information about the entity, and citation_clean, which gives me the other details (including the allegation descriptions).\nThe two data sets are linked by investigation numbers, which uniquely identify entities regulated by the TCEQ. Cross-referencing these allows you to identify specific allegations made against entities using the look-up tables created in the cleaning notebook.\nAgain, nov_clean is useful for the regulated entity name column.\n\nnov_clean &lt;- read_rds(\"data_processed/01-nov.rds\")\n\nnov_clean\n\n# A tibble: 65,635 × 21\n   regulated_entity_number regulated_entity_name business_type physical_location\n   &lt;chr&gt;                   &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;            \n 1 RN101384659             CITY OF ROBY          &lt;NA&gt;          &lt;NA&gt;             \n 2 RN105997860             CUTTERS LAWN AND LAN… &lt;NA&gt;          16 BEAR RUN      \n 3 RN105993190             THE WOODLANDS LAWN A… &lt;NA&gt;          18 QUICK STREAM …\n 4 RN102979168             LUCKY FOOD MART       RETAIL        807 BROWN ST     \n 5 RN106001027             RAINBIRD DESIGN SERV… &lt;NA&gt;          2498 ROLL DR STE…\n 6 RN101835825             SPEEDY MART           RETAIL        2050 BINGLE RD   \n 7 RN105629703             TAN VIET              POULTRY LIVE… 8914 COOKS RD    \n 8 RN105601694             HAPPY FARM            BROILER FARM  8916 COOKS RD    \n 9 RN104795398             JOEY VUONG FARM       &lt;NA&gt;          8209 OLD HWY     \n10 RN101187896             SUSAN CIRCLE COMMUNI… &lt;NA&gt;          &lt;NA&gt;             \n# ℹ 65,625 more rows\n# ℹ 17 more variables: physical_city &lt;chr&gt;, physical_state &lt;chr&gt;,\n#   physical_zip_code &lt;chr&gt;, county &lt;chr&gt;, investigation_number &lt;chr&gt;,\n#   investigation_approved_date &lt;date&gt;, nov_date &lt;date&gt;,\n#   coordinates_county_centroid &lt;chr&gt;, tceq_region &lt;chr&gt;,\n#   notice_of_violation_id &lt;chr&gt;, cat_a_violation_tracking_numbers &lt;chr&gt;,\n#   cat_a_violation_citations &lt;chr&gt;, cat_b_violation_tracking_numbers &lt;chr&gt;, …\n\n\ncitations_clean, with a wider time frame from 1998, is useful for violation descriptions and resolutions.\n\ncitations_clean &lt;- read_rds(\"data_processed/01-citations.rds\")\n\ncitations_clean\n\n# A tibble: 241,025 × 15\n   investigation_number investigation_approved_date notice_of_violation_id\n   &lt;chr&gt;                &lt;date&gt;                      &lt;chr&gt;                 \n 1 2021703              2024-11-08                  534344812024310       \n 2 2022240              2024-11-08                  360584652024304       \n 3 2022445              2024-11-08                  219368582024312       \n 4 2015194              2024-11-08                  399510332024303       \n 5 2022467              2024-11-08                  467347032024305       \n 6 2022467              2024-11-08                  467347032024305       \n 7 2021304              2024-11-08                  276390142024313       \n 8 2010056              2024-11-08                  695336872024313       \n 9 2015194              2024-11-08                  399510332024303       \n10 2018465              2024-11-08                  110615902024310       \n# ℹ 241,015 more rows\n# ℹ 12 more variables: violation_tracking_number &lt;chr&gt;,\n#   current_violation_status &lt;chr&gt;, violation_status_date &lt;date&gt;,\n#   violation_allegation &lt;chr&gt;, violation_resolution &lt;chr&gt;,\n#   violation_repeat_indicator &lt;lgl&gt;, compliance_due_date &lt;date&gt;,\n#   compliance_history_classification &lt;chr&gt;, violation_category &lt;chr&gt;,\n#   investigation_type &lt;chr&gt;, county &lt;chr&gt;, tceq_region &lt;chr&gt;"
  },
  {
    "objectID": "02-analysis.html#frequency-by-entity-and-county",
    "href": "02-analysis.html#frequency-by-entity-and-county",
    "title": "Analysis",
    "section": "Frequency by entity and county",
    "text": "Frequency by entity and county\nI will use the group, summarize, and arrange method to find basic information about the data, including which entities and counties have the most violation citations. My takeaways will reference both data sets and the category memo sent to me by the TCEQ information officer.\nFirst, I will group the entities, sum up their total violations from a separate column, and include the counties and investigation numbers for further research.\n\nentity_count &lt;- nov_clean |&gt;\n  group_by(regulated_entity_name, county) |&gt;\n  summarize(\n    total_violations = sum(total_violation_count),\n    investigation_numbers = paste(unique(investigation_number), collapse = \", \")\n  ) |&gt;\n  arrange(desc(total_violations))\n\n`summarise()` has grouped output by 'regulated_entity_name'. You can override\nusing the `.groups` argument.\n\nentity_count\n\n# A tibble: 25,811 × 4\n# Groups:   regulated_entity_name [25,474]\n   regulated_entity_name           county total_violations investigation_numbers\n   &lt;chr&gt;                           &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;                \n 1 PORT ARTHUR REFINERY            JEFFE…              943 901402, 923838, 9123…\n 2 BLANCHARD REFINING GALVESTON B… GALVE…              693 880047, 906279, 9057…\n 3 DOW TEXAS OPERATIONS FREEPORT   BRAZO…              667 864696, 887741, 8580…\n 4 CHEVRON PHILLIPS CHEMICAL CEDA… HARRIS              545 877580, 936808, 8997…\n 5 CHOCOLATE BAYOU PLANT           BRAZO…              517 942453, 981710, 9706…\n 6 INV NYLON CHEMICALS AMERICAS V… VICTO…              419 895156, 912649, 9211…\n 7 COVESTRO INDUSTRIAL PARK BAYTO… CHAMB…              401 880186, 900040, 9000…\n 8 EXXONMOBIL BAYTOWN REFINERY     HARRIS              389 865475, 880706, 8773…\n 9 INV NYLON CHEMICALS AMERICAS O… ORANGE              368 895472, 914893, 9156…\n10 BASF FREEPORT SITE              BRAZO…              367 877759, 919651, 9521…\n# ℹ 25,801 more rows\n\n\nData Takeaway: The Port Arthur Refinery has received the most environmental violations in Texas since 2010, with 943 notices. As the third-largest fuel, petrochemical, and heavy sour crude oil processing platform in the U.S., it has faced allegations such as leaving universal waste containers open, delaying cleanup of hydrocarbon spills near a loading rack, and failing to post required safety signs at waste management areas. Most recently, it was cited for failing to prevent unauthorized atmospheric emissions in July 2024.\nAnother crude oil refinery in Galveston takes second place, with a total of 693 notices. The Galveston Bay Refinery was recently cited for failing to prevent unauthorized atmospheric emissions, conducting sampling for air contaminants at the sulfur recovery unit, and performing a repair attempt for a closed vent system.\nCorrective actions for both companies include adjusting operational procedures for the equipment and training personnel.\nNow, I want to see the top emitters in Travis County, where UT Austin is nested.\n\ntravis_entity_count &lt;- nov_clean |&gt;\n  filter(county == \"TRAVIS\") |&gt;\n  group_by(regulated_entity_name) |&gt;\n  summarize(total_violations = sum(total_violation_count),\n            investigation_numbers = paste(unique(investigation_number), collapse = \", \")\n            ) |&gt;\n  arrange(desc(total_violations))\n\ntravis_entity_count\n\n# A tibble: 392 × 3\n   regulated_entity_name                  total_violations investigation_numbers\n   &lt;chr&gt;                                             &lt;dbl&gt; &lt;chr&gt;                \n 1 CITY OF PFLUGERVILLE                                 54 1603954              \n 2 WALNUT CREEK WASTEWATER TREATMENT PLA…               28 957528, 969067, 1085…\n 3 LAKE POINTE WWTP                                     21 970169, 1077094, 125…\n 4 BRIAR CREEK WWTP                                     20 995595, 1085055, 135…\n 5 AUSTIN WHITE LIME MCNEIL PLANT & QUAR…               18 1138295, 1138860, 13…\n 6 NAMELESS HOLLOW CONDOMINIUMS                         17 1058060, 1288218, 13…\n 7 SALAS HOLDINGS                                       17 1101922, 1692725     \n 8 LAKESIDE UTIL                                        14 1001707, 1266221, 15…\n 9 RANGE AT AUSTIN                                      14 1610014              \n10 CITY OF LAGO VISTA WWTP                              13 1106339, 1221756, 14…\n# ℹ 382 more rows\n\n\nData Takeaway: The top environmental violator in Travis County is the City of Pflugerville, totaling 54 notices. In January 2019, the city’s water treatment plant violated cryptosporidium removal requirements, falling short of minimum treatment standards. Cryptosporidium is a microscopic parasite commonly found in water sources contaminated with fecal matter. Its removal requirements are mandated by the Environmental Protection Agency (EPA) to ensure safe drinking water for the public.\nThe second most cited entity in Travis County is a wastewater treatment plant in Walnut Creek, accounting for 28 notices. According to the TCEQ, the entity failed to properly operate and maintain its facility, being cited for severely rusted and eroded catwalks in the primary treatment area. Additionally, it failed to prevent the discharge of visible foam beyond trace amounts and persistent frothing in November 2022.\nDo the violations vary by county? I will aggregate all individual county appearances to find out.\n\ncounty_violations &lt;- citations_clean |&gt;\n  group_by(county) |&gt;\n  summarize(\n    total_violations = n()) |&gt;\n  arrange(desc(total_violations)) |&gt;\n  head(10)\n\ncounty_violations\n\n# A tibble: 10 × 2\n   county     total_violations\n   &lt;chr&gt;                 &lt;int&gt;\n 1 HARRIS                28179\n 2 JEFFERSON              8633\n 3 BRAZORIA               6812\n 4 NUECES                 4962\n 5 MONTGOMERY             4931\n 6 ORANGE                 4512\n 7 HIDALGO                4066\n 8 TARRANT                3891\n 9 EL PASO                3826\n10 GALVESTON              3581\n\n\nData Takeaway: Harris County takes the lead in the number of entities cited for environmental violations since 1998, with over 28,179 citations released in total. Jefferson County takes a distant second with 8,633 notices.\nI can also visualize this data in a bar chart. I referred to Nathan Yau’s Data Points textbook to find the graph type that would be the best fit to the display this information. I also used the ggplot function reference to make it aesthetically pleasing.\n\nggplot(county_violations,\n       aes(y = reorder(county, total_violations), x = total_violations)) +\n  geom_col() +\n  geom_text(aes(label = total_violations), hjust = 1.1, color = \"white\") +\n  labs(\n    title = \"Who’s polluting Texas? Harris County takes the lead\",\n    subtitle = str_wrap(\"Harris County has the highest number of entities cited for environmental violations since 1998, according to data from the Texas Commission on Environmental Quality, with over 28,179 citations handed out in total. Jefferson County is a distant second.\"),\n    caption = \"By Angelica Ruzanova\",\n    x = \"Total violations\",\n    y = \"County\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nTo create a choropleth map on Datawrapper, I am going to download a csv file with all county names.\n\ncounty_violations_all &lt;- citations_clean |&gt;\n  group_by(county) |&gt;\n  summarize(total_violations = n()) |&gt;\n  arrange(desc(total_violations))\n\ncounty_violations_all |&gt; write_csv(\"data_processed/01-county-violations-all.csv\")\n\nThe finished map can be found here: https://datawrapper.dwcdn.net/GLOGc/1/"
  },
  {
    "objectID": "02-analysis.html#harris-county---a-closer-look",
    "href": "02-analysis.html#harris-county---a-closer-look",
    "title": "Analysis",
    "section": "Harris County - a closer look",
    "text": "Harris County - a closer look\nConsidering the enormous gap that Harris County has with other counties, it would be worth taking a look at its top emitters separately. Using the same logic, I will group, summarize, and arrange the filtered county.\n\nharris_top_emitters &lt;- nov_clean |&gt;\n  filter(county == \"HARRIS\") |&gt;\n  group_by(regulated_entity_name) |&gt; \n  summarize(total_violations = sum(total_violation_count),\n            investigation_numbers = paste(unique(investigation_number), collapse = \", \")\n            ) |&gt;\n  arrange(desc(total_violations))\n\nharris_top_emitters\n\n# A tibble: 2,685 × 3\n   regulated_entity_name                  total_violations investigation_numbers\n   &lt;chr&gt;                                             &lt;dbl&gt; &lt;chr&gt;                \n 1 CHEVRON PHILLIPS CHEMICAL CEDAR BAYOU…              545 877580, 936808, 8997…\n 2 EXXONMOBIL BAYTOWN REFINERY                         389 865475, 880706, 8773…\n 3 SHELL DEER PARK CHEMICALS                           356 878837, 901124, 8998…\n 4 PASADENA REFINING SYSTEM PRSI                       297 968337, 965148, 9705…\n 5 LUBRIZOL DEER PARK                                  292 922552, 958467, 9815…\n 6 HOUSTON REFINING                                    240 885439, 957213, 9964…\n 7 HOUSTON PLANT                                       222 952341, 989856, 1050…\n 8 PASADENA PLASTICS COMPLEX                           213 870371, 906737, 9227…\n 9 INEOS POLYETHYLENE NORTH AMERICA LA P…              205 950851, 957649, 1094…\n10 EQUISTAR CHEMICALS CHANNELVIEW COMPLEX              197 879378, 949428, 9702…\n# ℹ 2,675 more rows\n\n\nData Takeaway: The Chevron Phillips chemical plant in Harris County, Texas - home to the state’s highest number of environmental violations - leads the number of environmental citations in the county. Its Cedar Bayou facility has received 545 notices, including violations for failing to detect a rail car leak and prevent unauthorized emissions.\nAn ExxonMobil refinery in Baytown comes second with 389 violation citations, example of which include exceeding the hydrogen sulfide and nitrogen oxide emissions within the daily cap and leaving open-ended lines."
  },
  {
    "objectID": "02-analysis.html#trends-by-year",
    "href": "02-analysis.html#trends-by-year",
    "title": "Analysis",
    "section": "Trends by year",
    "text": "Trends by year\nPolicy and technological breakthroughs impact the rate at which environmental violations may occur, so it would be interesting to look at the data on a yearly basis. This can be accomplished with the same GSA method and a new column that extracts the year.\n\ncitations_clean_year &lt;- citations_clean |&gt; \n  mutate(year = year(investigation_approved_date)) \n\nNow onto grouping by year to see the trends.\n\nyear_trends &lt;- citations_clean_year |&gt; \n  group_by(year) |&gt; \n  summarize(\n    total_violations = n()) |&gt; \n  arrange(desc(total_violations))\n\nyear_trends\n\n# A tibble: 27 × 2\n    year total_violations\n   &lt;dbl&gt;            &lt;int&gt;\n 1  2019            20803\n 2  2023            19343\n 3  2022            18695\n 4  2024            18246\n 5  2017            17905\n 6  2016            17704\n 7  2020            17657\n 8  2018            17474\n 9  2021            17321\n10  2015            16602\n# ℹ 17 more rows\n\n\nData Takeaway: Within the last 27 years, 2019 comes on top with the number of environmental violation notices handed out to entities in Texas, with a total of 20,803 citations that year alone. The year 2023 comes as a close second, with 19,343 citations."
  },
  {
    "objectID": "02-analysis.html#trends-in-greater-austin",
    "href": "02-analysis.html#trends-in-greater-austin",
    "title": "Analysis",
    "section": "Trends in Greater Austin",
    "text": "Trends in Greater Austin\nA line chart would help visualize these trends, filtered to only show counties in the Greater Austin area over the last 15 years.\nThe process starts with filtering and creating a new object.\n\ncounty_trends &lt;- citations_clean_year |&gt;\n  filter(\n    (county == \"BASTROP\" | county == \"TRAVIS\" | county == \"CALDWELL\" | county == \"COMAL\" | county == \"GUADALUPE\" | county == \"HAYS\" | county == \"BEXAR\") &\n    year &gt; 2010 & year &lt; 2024\n    ) |&gt;\n  group_by(year, county) |&gt;\n  summarize(total_violations = n())\n\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n\ncounty_trends\n\n# A tibble: 91 × 3\n# Groups:   year [13]\n    year county    total_violations\n   &lt;dbl&gt; &lt;chr&gt;                &lt;int&gt;\n 1  2011 BASTROP                 26\n 2  2011 BEXAR                  125\n 3  2011 CALDWELL                 7\n 4  2011 COMAL                   17\n 5  2011 GUADALUPE               10\n 6  2011 HAYS                    28\n 7  2011 TRAVIS                  94\n 8  2012 BASTROP                 31\n 9  2012 BEXAR                  149\n10  2012 CALDWELL                10\n# ℹ 81 more rows\n\n\nAnd then plotting it.\n\nggplot(county_trends, \n       aes(x = year, y = total_violations, color = county)) +\n  geom_point() +\n  geom_line(size = 0.5, aes(color = county)) +\n  scale_x_continuous(breaks = 2010:2023) +\n  labs(\n    title = str_wrap(\"Keep Austin Green: Environmental violations peak in 2019\"),\n    subtitle = str_wrap(\"Environmental violations in Greater Austin counties peaked in 2019 with 770 notices issued to businesses and entities, the highest total recorded since 2010 and consistent with statewide trends, according to Texas Commission on Environmental Quality data. Notices declined in the following years, potentially due to the COVID-19 pandemic, before rising sharply again in 2023 to 595.\"),\n    caption = \"By Angelica Ruzanova\",\n    x = \"Year\",\n    y = \"Total violations\",\n    color = \"County\"\n  ) +\n  theme_minimal()\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\n\n\n\n\nTo enhance the graph labels, I will do another grouping to see which years are actually on top.\n\nyear_trends &lt;- citations_clean_year |&gt; \n  filter(\n    (county == \"BASTROP\" | county == \"TRAVIS\" | county == \"CALDWELL\" | county == \"COMAL\" | county == \"GUADALUPE\" | county == \"HAYS\" | county == \"BEXAR\") &\n    year &gt; 2010 & year &lt; 2024\n  ) |&gt;\n  group_by(year) |&gt; \n  summarize(\n    total_violations = n()) |&gt; \n  arrange(desc(total_violations))\n\nyear_trends\n\n# A tibble: 13 × 2\n    year total_violations\n   &lt;dbl&gt;            &lt;int&gt;\n 1  2019              770\n 2  2015              613\n 3  2023              595\n 4  2022              588\n 5  2013              573\n 6  2017              567\n 7  2018              559\n 8  2021              539\n 9  2016              496\n10  2020              472\n11  2014              451\n12  2012              447\n13  2011              307\n\n\nData Takeaway: In Greater Austin counties, 2019 marked the highest number of environmental violations (770), making it a standout year. It was followed by a decline in violations, potentially due to the COVID-19 pandemic, with a returning spike in 2023 at 595 notices.\nTo use the chart in my summary, I will save it as a jpg.\n\nsaved_county_line &lt;- ggplot(county_trends, \n       aes(x = year, y = total_violations, color = county)) +\n  geom_point() +\n  geom_line(size = 0.5, aes(color = county)) +\n  scale_x_continuous(breaks = 2010:2023) +\n  labs(\n    title = str_wrap(\"Keep Austin Green: Environmental violations peak in 2019\"),\n    subtitle = str_wrap(\"Environmental violations in Greater Austin counties peaked in 2019 with 770 notices issued to businesses and entities, the highest total recorded since 2010 and consistent with statewide trends, according to Texas Commission on Environmental Quality data. Notices declined in the following years, potentially due to the COVID-19 pandemic, before rising sharply again in 2023 to 595.\"),\n    caption = \"By Angelica Ruzanova\",\n    x = \"Year\",\n    y = \"Total violations\",\n    color = \"County\"\n  ) +\n  theme_minimal()\n  \nggsave(\"figures/county-line.png\")\n\nSaving 7 x 5 in image"
  },
  {
    "objectID": "02-analysis.html#frequency-by-category",
    "href": "02-analysis.html#frequency-by-category",
    "title": "Analysis",
    "section": "Frequency by category",
    "text": "Frequency by category\nNow, I am curious about the general category appearances. Their definitions are as follows:\nCategory A violations require automatic initiation of formal enforcement action when documented during an investigation. Category B violations trigger a NOV at the first occurrence, with formal enforcement if not corrected by deadline or if repeated within two consecutive investigations in a five-year period, unless an extension is approved. Category C violations may lead to formal enforcement if the same violation occurs three times within a five-year period, with decisions on enforcement made by staff management.\n\ncategory_count &lt;- citations_clean |&gt;\n  group_by(violation_category) |&gt;\n  summarize(category_count = n()) |&gt;\n  arrange(desc(category_count))\n\ncategory_count\n\n# A tibble: 3 × 2\n  violation_category category_count\n  &lt;chr&gt;                       &lt;int&gt;\n1 B                          154745\n2 C                           84935\n3 A                            1345\n\n\nData Takeaway: Category B environmental violations - those that require formal enforcement action if the violation is not corrected by an established deadline - appear almost double the amount than Category C and A combined, with 154,745 in total since 1998 in Texas.\nSo, which county has the most Category A violations in Texas? This can be found by grouping the counties within the filtered category.\n\ncategory_a_county &lt;- citations_clean |&gt;\n  filter(violation_category == \"A\") |&gt;\n  group_by(county) |&gt;\n  summarize(category_a_count = n()) |&gt;\n  arrange(desc(category_a_count))\n\ncategory_a_county\n\n# A tibble: 175 × 2\n   county    category_a_count\n   &lt;chr&gt;                &lt;int&gt;\n 1 MIDLAND                131\n 2 LUBBOCK                 83\n 3 HARRIS                  48\n 4 ECTOR                   44\n 5 TARRANT                 35\n 6 GILLESPIE               34\n 7 CAMERON                 33\n 8 GALVESTON               29\n 9 DALLAS                  27\n10 MARTIN                  25\n# ℹ 165 more rows\n\n\nMost Category A violations per entity award goes to…\n\ncategory_a_entity &lt;- nov_clean |&gt;\n  filter(!is.na(cat_a_violation_citations)) |&gt;\n  group_by(regulated_entity_name) |&gt;\n  summarize(total_cat_a_citations = n_distinct(cat_a_violation_citations)) |&gt;\n  arrange(desc(total_cat_a_citations))\n\ncategory_a_entity\n\n# A tibble: 746 × 2\n   regulated_entity_name                     total_cat_a_citations\n   &lt;chr&gt;                                                     &lt;int&gt;\n 1 BLANCHARD REFINING GALVESTON BAY REFINERY                     4\n 2 GREENWOOD VENTURES                                            4\n 3 LAKEWOOD WATER SYSTEM                                         4\n 4 CITY OF PAINT ROCK                                            3\n 5 CLEAR CREEK RESORT WATER SYSTEM                               3\n 6 ELM GROVE MOBILE HOME PARK                                    3\n 7 FORT JACKSON MOBILE ESTATES                                   3\n 8 GREEN HILLS SUBDIVISION                                       3\n 9 JAMES LAKE GAS PLANT                                          3\n10 KING RANCH GAS PLANT                                          3\n# ℹ 736 more rows\n\n\nData Takeaway: Midland, a Texas county halfway between Fort Worth and El Paso, contains entities with the highest number of Category A environmental violations, totaling 131 since 1998.\nMarathon Petroleum, Greenwood Ventures, and the Lakewood Water System are tied for the top spot for Category A violations by entity, each totaling 4 citations since 2010. Category A can be considered more severe due to a lower due diligence threshold.\nAs far as year-by-year trends of how the categories are changing, I can pivot wider to add new columns and arrange based on the category of interest.\n\ncitations_clean_year |&gt; \n  group_by(year, violation_category) |&gt; \n  summarize(violation_count = n()) |&gt;\n  pivot_wider(\n    names_from = violation_category,      \n    values_from = violation_count \n    ) |&gt;\n  arrange(desc(A))\n\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 27 × 4\n# Groups:   year [27]\n    year     B     C     A\n   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;\n 1  2011  7776  4249   241\n 2  2024 11704  6339   203\n 3  2023 13013  6211   119\n 4  2013  9788  5316   113\n 5  2019 12806  7900    97\n 6  2022 11378  7233    84\n 7  2018 11852  5539    83\n 8  2014 10347  5604    76\n 9  2020 10608  6978    71\n10  2021 10596  6675    50\n# ℹ 17 more rows\n\n\nData Takeaway: When it comes to Category A environmental violations - or those that require automatic action when documented during an investigation - 2011 takes the lead with 241 handed out to Texas agencies. Although the data is incomplete, 2024 comes as a close second with 203."
  },
  {
    "objectID": "02-analysis.html#in-depth-by-industry",
    "href": "02-analysis.html#in-depth-by-industry",
    "title": "Analysis",
    "section": "In-depth by industry",
    "text": "In-depth by industry\nGiven that we have two complimentary sets, we can also find out which industries come out on top by doing some grouping and summarizing. I excluded the unnamed columns.\n\nindustry_count &lt;- nov_clean |&gt;\n  group_by(business_type) |&gt;\n  summarize(\n    total_violations = n()) |&gt;\n  filter(!is.na(business_type)) |&gt;\n  arrange(desc(total_violations))\n\nindustry_count\n\n# A tibble: 4,094 × 2\n   business_type                           total_violations\n   &lt;chr&gt;                                              &lt;int&gt;\n 1 RETAIL                                              7115\n 2 DOMESTIC                                            4257\n 3 INDUSTRIAL CHEMICAL MANUFACTURING PLANT             1735\n 4 WATER SUPPLY                                        1630\n 5 PUBLIC WATER SUPPLY                                 1339\n 6 FLEET REFUELING                                     1265\n 7 INDUSTRIAL                                           465\n 8 MOBILE HOME PARK                                     370\n 9 OIL AND GAS PRODUCTION                               364\n10 PUBLIC WATER SYSTEM                                  298\n# ℹ 4,084 more rows\n\n\nIt seems this data was manually typed by TCEQ employees, so some of the rows repeat due to naming differentiation. I used Claude LLM to help me sort some of the business types into broader industries. Then, I manually entered names that were misspelled, abbreviated, or unclassified by the model.\nI will begin by applying categorizations based on identified keywords (with normalized capitalization). This needs to be manually checked based on individual judgmenet.\n\nindustry_count &lt;- nov_clean |&gt;\n  mutate(\n    business_type = toupper(business_type),\n    industry = case_when(\n      grepl(\"MOBILE HOME|RV PARK|TRAILER PARK|CAMP|MANUFACTURED HOUSING|MHP|R V PARK|RECREATIONAL VEHICLE PARK|HOME PARK|MOBILE HOME COMPLEX\", business_type) ~ \"Mobile Home Parks\",\n      grepl(\"REFIN|CHEMICAL|MANUFACTURING|PETROLEUM|PROPYLENE PRODUCTION|PRODUCTION OF ACRYLIC AND METHACRYLIC MONOMERS|BULK LIQUID STORAGE TERMINAL|POLYETHYLENE|POLYPROPYLENE|ETHYLENE|PROPYLENE|BENZENE|BUTADIEN|FOR HIRE LIQUID STORAGE AND TRANSFER|SYNTHETIC RUBBER|EURECAT|ZEOLITE|ACRYLIC ACID|ESTERS|ACETIC ACID|MERCAPTANS|SULFIDES|COKE|RESIN|AMMONIA|BULK STORAGE|POLY CATALYST|SODIUM CHROMATEOIL|GAS|DRILLING|EXPLORATION|WELL|TANK BATTERY|CRUDE OIL|SODIUM CHROMATE|ACETATE|PROPLYLENE|TRENCH BURNER|CHEMCIALS|FUEL|GLYCINE|PEROXIDES\", business_type) ~ \"Petroleum & Chemical Manufacturing\",\n      grepl(\"CONSTRUCTION|BUILDING|BRIDGE|EXCAVATION|SITE|CONCRETE|ROCK CRUSHING|SES|SAND|HOMEBUILDER|BASE|INDUSTRIAL|STEEL|GLASS|RUBBER|PULP|LUMBER|WOOD|IRON|METAL|ASPHALT|MINING|PREVENTERS\", business_type) ~ \"Construction & Industrial\",\n      grepl(\"WASTE|RECYCLING|COMPOSTING|HAZARDOUS|DISPOSAL|SLUDGE TRANSPORTER|DISCHARGE\", business_type) ~ \"Waste\",\n      grepl(\"WATER|WASTEWATER|IRRIGATION|TREATMENT|PWS\", business_type) ~ \"Water Management\",\n      grepl(\"POWER|ELECTRIC|GENERATION|SOLAR|WIND\", business_type) ~ \"Energy Generation\",\n      grepl(\"RETAIL|SHOP|DOMESTIC|RESIDENTIAL|RESIDENCE|GROCERY STORE|ATHLETIC|CONVENIENCE STORE|TECHNOLOGY\", business_type) ~ \"Retail & Domestic Services\",\n      grepl(\"TRANSPORTATION|FLEET|TRUCKING|AIRCRAFT REFUELING|MARINA|MARINE\", business_type) ~ \"Transportation\",\n      grepl(\"AGRICULTURE|FARM|CROP|LIVESTOCK|FOOD|COFFEE|MEAT|POULTRY|SEAFOOD|DAIRY|MILK|EGG|SHRIMP|GRAIN|ELEVATOR|RESTAURANT|WHOLESALE|AGRICULTURAL|COTTON|BEEF\", business_type) ~ \"Agriculture\",\n      grepl(\"PRIVATE|LAND|PROPERTY|TRACT|CLEARING|DEVELOPMENT\", business_type) ~ \"Land Use\",\n      grepl(\"GOVERNMENT|MUNICIPAL|UTILITY|PUBLIC|CHURCH|DAY CARE|STATE PARK|CORRECTIONAL INSTITUTION|RECREATIONAL PARK|SCHOOL|RESEARCH|PATROL|CLEBURNE|NAVAL|HOSPITAL|STATE OWNED\", business_type) ~ \"Government and Public Services\",\n      TRUE ~ \"Other\")\n  ) |&gt;\n  group_by(industry) |&gt;\n  summarize(total_violations = n()) |&gt;\n  arrange(desc(total_violations))\n\nindustry_count\n\n# A tibble: 12 × 2\n   industry                           total_violations\n   &lt;chr&gt;                                         &lt;int&gt;\n 1 Other                                         30446\n 2 Retail & Domestic Services                    12522\n 3 Petroleum & Chemical Manufacturing             9865\n 4 Water Management                               5527\n 5 Construction & Industrial                      2986\n 6 Mobile Home Parks                              1224\n 7 Agriculture                                     991\n 8 Government and Public Services                  641\n 9 Waste                                           496\n10 Land Use                                        429\n11 Energy Generation                               319\n12 Transportation                                  189\n\n\nThis is where I view the “Other” category and manually analyze the names, including them with the other industries where appropriate:\n\nother_category_data &lt;- nov_clean |&gt;\n  mutate(\n    business_type = toupper(business_type),\n    industry = case_when(\n      grepl(\"MOBILE HOME|RV PARK|TRAILER PARK|CAMP|MANUFACTURED HOUSING|MHP|R V PARK|RECREATIONAL VEHICLE PARK|HOME PARK|MOBILE HOME COMPLEX\", business_type) ~ \"Mobile Home Parks\",\n      grepl(\"REFIN|CHEMICAL|MANUFACTURING|PETROLEUM|PROPYLENE PRODUCTION|PRODUCTION OF ACRYLIC AND METHACRYLIC MONOMERS|BULK LIQUID STORAGE TERMINAL|POLYETHYLENE|POLYPROPYLENE|ETHYLENE|PROPYLENE|BENZENE|BUTADIEN|FOR HIRE LIQUID STORAGE AND TRANSFER|SYNTHETIC RUBBER|EURECAT|ZEOLITE|ACRYLIC ACID|ESTERS|ACETIC ACID|MERCAPTANS|SULFIDES|COKE|RESIN|AMMONIA|BULK STORAGE|POLY CATALYST|SODIUM CHROMATEOIL|GAS|DRILLING|EXPLORATION|WELL|TANK BATTERY|CRUDE OIL|SODIUM CHROMATE|ACETATE|PROPLYLENE|TRENCH BURNER|CHEMCIALS|FUEL|GLYCINE|PEROXIDES\", business_type) ~ \"Petroleum & Chemical Manufacturing\",\n      grepl(\"CONSTRUCTION|BUILDING|BRIDGE|EXCAVATION|SITE|CONCRETE|ROCK CRUSHING|SES|SAND|HOMEBUILDER|BASE|INDUSTRIAL|STEEL|GLASS|RUBBER|PULP|LUMBER|WOOD|IRON|METAL|ASPHALT|MINING|PREVENTERS\", business_type) ~ \"Construction & Industrial\",\n      grepl(\"WASTE|RECYCLING|COMPOSTING|HAZARDOUS|DISPOSAL|SLUDGE TRANSPORTER|DISCHARGE\", business_type) ~ \"Waste\",\n      grepl(\"WATER|WASTEWATER|IRRIGATION|TREATMENT|PWS\", business_type) ~ \"Water Management\",\n      grepl(\"POWER|ELECTRIC|GENERATION|SOLAR|WIND\", business_type) ~ \"Energy Generation\",\n      grepl(\"RETAIL|SHOP|DOMESTIC|RESIDENTIAL|RESIDENCE|GROCERY STORE|ATHLETIC|CONVENIENCE STORE|TECHNOLOGY\", business_type) ~ \"Retail & Domestic Services\",\n      grepl(\"TRANSPORTATION|FLEET|TRUCKING|AIRCRAFT REFUELING|MARINA|MARINE\", business_type) ~ \"Transportation\",\n      grepl(\"AGRICULTURE|FARM|CROP|LIVESTOCK|FOOD|COFFEE|MEAT|POULTRY|SEAFOOD|DAIRY|MILK|EGG|SHRIMP|GRAIN|ELEVATOR|RESTAURANT|WHOLESALE|AGRICULTURAL|COTTON|BEEF\", business_type) ~ \"Agriculture\",\n      grepl(\"PRIVATE|LAND|PROPERTY|TRACT|CLEARING|DEVELOPMENT\", business_type) ~ \"Land Use\",\n      grepl(\"GOVERNMENT|MUNICIPAL|UTILITY|PUBLIC|CHURCH|DAY CARE|STATE PARK|CORRECTIONAL INSTITUTION|RECREATIONAL PARK|SCHOOL|RESEARCH|PATROL|CLEBURNE|NAVAL|HOSPITAL|STATE OWNED\", business_type) ~ \"Government and Public Services\",\n      TRUE ~ \"Other\")\n  ) |&gt;\n  filter(industry == \"Other\") |&gt;\n  group_by(business_type) |&gt;\n  summarize(total_violations = n()) |&gt;\n  arrange(desc(total_violations))\n\nother_category_data\n\n# A tibble: 1,184 × 2\n   business_type      total_violations\n   &lt;chr&gt;                         &lt;int&gt;\n 1 &lt;NA&gt;                          28212\n 2 N/D                              22\n 3 50000                            17\n 4 GENTLEMEN'S CLUB                 17\n 5 DUSTY ROAD                       16\n 6 QUARRY                           14\n 7 DANCE CLUB                       13\n 8 RIVER RESORT                     13\n 9 AUTO BODY REPAIR                 12\n10 COMPRESSOR STATION               12\n# ℹ 1,174 more rows\n\n\nI still ended up with over 30,000 results under the “Other” section. This include business types labeled Dustry Road (the only one that appears to be under it is the City of Cameron),\nHowever, the other industries are now more accurate.\nData takeaway: Among the included industries, retail and domestic businesses receive the most environmental quality violations in Texas, with 12,522 recorded in total since 2010. Petroleum and chemical manufacturing comes second with 8,325 notices.\nLet’s visualize this in a bar chart.\n\nggplot(industry_count, \n       aes(x = reorder(industry, total_violations), y = total_violations)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(\n    title = str_wrap(\"Money makes the world go 'round: Retail businesses receive the most environmental violations in Texas\"),\n    subtitle = str_wrap(\"Businesses in the retail and domestic industry received 12,519 citations since 2010, according to data from the Texas Commission on Environmental Quality. This includes gas stations and grocery stores. Petroleum and chemical manufacturers come second, totaling 8,325 citations.\"),\n    caption = \"By Angelica Ruzanova\",\n    x = \"Industry\",\n    y = \"Total violations\",\n    fill = \"Industry\"\n  ) +\n  theme_minimal()"
  },
  {
    "objectID": "02-analysis.html#allegations",
    "href": "02-analysis.html#allegations",
    "title": "Analysis",
    "section": "Allegations",
    "text": "Allegations\nI am curious what kinds of environmental allegations are most commonly cited, so I will group by violation_allegation to find out.\n\nallegation_count &lt;- citations_clean |&gt;\n  group_by(violation_allegation) |&gt;\n  summarize(count = n()) |&gt;\n  arrange(desc(count))\n\nallegation_count\n\n# A tibble: 104,277 × 2\n   violation_allegation                                                    count\n   &lt;chr&gt;                                                                   &lt;int&gt;\n 1 Failure to meet the limit for one or more permit parameter              61607\n 2 NON-RPT VIOS FOR MONIT PER OR PIPE                                       4417\n 3 Failed to maintain compliance with the permitted effluent limits.         402\n 4 Failure to submit an annual registration renewal for a dry-cleaning fa…   323\n 5 Failed to prevent the unauthorized discharge of wastewater.               299\n 6 Failure to prevent the unauthorized discharge of wastewater.              260\n 7 Failure to provide records immediately upon request of agency personne…   256\n 8 Failed to ensure that the facility and all of its systems of collectio…   227\n 9 Failure to submit a Report of Surface Water Used for the previous cale…   216\n10 Failure to provide amended registration for any change or additional i…   199\n# ℹ 104,267 more rows\n\n\nData Takeaway: The most common violation allegation from the TEQC is a “failure to meet the limit for one or more permit parameter,” cited 61,607 times since 1998. This refers to situations where a regulated entity does not comply with the specific limits set in their environmental permit, such as the amount of pollutants emitted, water quality standards, or other environmental criteria, according to the TEQC website.\nOther commonly cited allegations are failures to report violations within the designated monitoring period, noncompliance with waste water limits, and issues with dry-cleaning facility registration renewals."
  },
  {
    "objectID": "01-cleaning.html",
    "href": "01-cleaning.html",
    "title": "Cleaning",
    "section": "",
    "text": "The goal of this notebook is to prepare data from the Texas Commission on Environmental Quality - Notices Of Violation (NOV) and Violation Citations - for further analysis. Cleaned data means each data source will have clean variable names, correct data types, and clean categorical values."
  },
  {
    "objectID": "01-cleaning.html#set-up",
    "href": "01-cleaning.html#set-up",
    "title": "Cleaning",
    "section": "Set up",
    "text": "Set up\nThe first step is to load the library packages that will assist with certain tasks in this project.\n\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(DT)"
  },
  {
    "objectID": "01-cleaning.html#importing-the-data",
    "href": "01-cleaning.html#importing-the-data",
    "title": "Cleaning",
    "section": "Importing the data",
    "text": "Importing the data\nThe data I downloaded comes from the Texas Open Data Portal. It is already in my files’ data_raw folder, so the next steps would be to import it, assign it to an R object, and glimpse at it.\nTo lowercase the columns into code-friendly format, I will use the clean_names() function.\n\ncitations_raw &lt;- read_csv(\"data_raw/20241112.csv\") |&gt; clean_names()\n\nRows: 241025 Columns: 15\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (11): Investigation Approved Date, Current Violation Status, Violation S...\ndbl  (3): Investigation Number, Notice of Violation ID, Violation Tracking N...\nlgl  (1): Violation Repeat Indicator\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nIt is a good idea to glimpse at the data to ensure the columns are in proper format.\n\ncitations_raw |&gt; glimpse()\n\nRows: 241,025\nColumns: 15\n$ investigation_number              &lt;dbl&gt; 1708769, 912908, 1385762, 1747889, 1…\n$ investigation_approved_date       &lt;chr&gt; \"May 13, 2021\", \"Jun 20, 2011\", \"Nov…\n$ notice_of_violation_id            &lt;dbl&gt; 5.734687e+14, 1.123664e+14, 4.860436…\n$ violation_tracking_number         &lt;dbl&gt; 775850, 420378, 629005, 885714, 7216…\n$ current_violation_status          &lt;chr&gt; \"RESOLVED\", \"RESOLVED\", \"RESOLVED\", …\n$ violation_status_date             &lt;chr&gt; \"Aug 26, 2021\", \"Sep 29, 2011\", \"Nov…\n$ violation_allegation              &lt;chr&gt; \"Failure to maintain inadequate stor…\n$ violation_resolution              &lt;chr&gt; \"On July 9, 2021, the TCEQ DFW Regio…\n$ violation_repeat_indicator        &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, F…\n$ compliance_due_date               &lt;chr&gt; \"Jun 13, 2021\", \"Jul 20, 2011\", NA, …\n$ compliance_history_classification &lt;chr&gt; \"MODERATE\", \"MINOR\", \"MODERATE\", \"MO…\n$ violation_category                &lt;chr&gt; \"B\", \"C\", \"B\", \"B\", \"B\", \"B\", \"C\", \"…\n$ investigation_type                &lt;chr&gt; \"Compliance Investigation\", \"Complia…\n$ county                            &lt;chr&gt; \"JOHNSON\", \"TRINITY\", \"RAINS\", \"POLK…\n$ tceq_region                       &lt;chr&gt; \"REGION 04 - DFW METROPLEX\", \"REGION…\n\n\nRight off the bat, I notice that I have to change the date formats and the investigation number, notice of violation ID, and violation tracking number columns to be character values since they are categorical variables."
  },
  {
    "objectID": "01-cleaning.html#fixing-the-formats",
    "href": "01-cleaning.html#fixing-the-formats",
    "title": "Cleaning",
    "section": "Fixing the formats",
    "text": "Fixing the formats\nFor the date to not show up as a numerical value, I will use one of the lubridate functions, mutate(), to modify it. I referred to lubridate documentation for the right format.\nI am arranging the dates in a descending order to see the most recent data.\n\ncitations_clean &lt;- citations_raw |&gt;\n  mutate(\n    investigation_approved_date = mdy(investigation_approved_date),\n    violation_status_date = mdy(violation_status_date),\n    compliance_due_date = mdy(compliance_due_date),\n    investigation_number = as.character(investigation_number),\n    notice_of_violation_id = as.character(notice_of_violation_id),\n    violation_tracking_number = as.character(violation_tracking_number)\n  ) |&gt;\n  arrange(desc(investigation_approved_date))\n\ncitations_clean\n\n# A tibble: 241,025 × 15\n   investigation_number investigation_approved_date notice_of_violation_id\n   &lt;chr&gt;                &lt;date&gt;                      &lt;chr&gt;                 \n 1 2021703              2024-11-08                  534344812024310       \n 2 2022240              2024-11-08                  360584652024304       \n 3 2022445              2024-11-08                  219368582024312       \n 4 2015194              2024-11-08                  399510332024303       \n 5 2022467              2024-11-08                  467347032024305       \n 6 2022467              2024-11-08                  467347032024305       \n 7 2021304              2024-11-08                  276390142024313       \n 8 2010056              2024-11-08                  695336872024313       \n 9 2015194              2024-11-08                  399510332024303       \n10 2018465              2024-11-08                  110615902024310       \n# ℹ 241,015 more rows\n# ℹ 12 more variables: violation_tracking_number &lt;chr&gt;,\n#   current_violation_status &lt;chr&gt;, violation_status_date &lt;date&gt;,\n#   violation_allegation &lt;chr&gt;, violation_resolution &lt;chr&gt;,\n#   violation_repeat_indicator &lt;lgl&gt;, compliance_due_date &lt;date&gt;,\n#   compliance_history_classification &lt;chr&gt;, violation_category &lt;chr&gt;,\n#   investigation_type &lt;chr&gt;, county &lt;chr&gt;, tceq_region &lt;chr&gt;\n\n\nI will quickly look at the summary of the 240,000 rows I will be working with.\n\nsummary(citations_clean)\n\n investigation_number investigation_approved_date notice_of_violation_id\n Length:241025        Min.   :1998-12-09          Length:241025         \n Class :character     1st Qu.:2015-01-27          Class :character      \n Mode  :character     Median :2018-07-20          Mode  :character      \n                      Mean   :2018-04-28                                \n                      3rd Qu.:2021-09-22                                \n                      Max.   :2024-11-08                                \n                                                                        \n violation_tracking_number current_violation_status violation_status_date\n Length:241025             Length:241025            Min.   :2001-02-20   \n Class :character          Class :character         1st Qu.:2015-07-23   \n Mode  :character          Mode  :character         Median :2019-02-11   \n                                                    Mean   :2018-09-29   \n                                                    3rd Qu.:2022-03-29   \n                                                    Max.   :2024-11-08   \n                                                                         \n violation_allegation violation_resolution violation_repeat_indicator\n Length:241025        Length:241025        Mode :logical             \n Class :character     Class :character     FALSE:233706              \n Mode  :character     Mode  :character     TRUE :7319                \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n compliance_due_date  compliance_history_classification violation_category\n Min.   :1999-06-21   Length:241025                     Length:241025     \n 1st Qu.:2015-07-22   Class :character                  Class :character  \n Median :2019-03-29   Mode  :character                  Mode  :character  \n Mean   :2020-04-05                                                       \n 3rd Qu.:2022-07-15                                                       \n Max.   :3000-12-31                                                       \n NA's   :157222                                                           \n investigation_type    county          tceq_region       \n Length:241025      Length:241025      Length:241025     \n Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character  \n                                                         \n                                                         \n                                                         \n                                                         \n\n\nThe most recent data is from November 8, 2024. The oldest data goes back to December 9, 1998.\nTo track specific investigation numbers, I will put this data in a look-up table format.\n\n#citations_clean |&gt; datatable()"
  },
  {
    "objectID": "01-cleaning.html#a-different-set---import-and-clean",
    "href": "01-cleaning.html#a-different-set---import-and-clean",
    "title": "Cleaning",
    "section": "A different set - import and clean",
    "text": "A different set - import and clean\nThis data comes from the same organization, but it includes the name and specific geographic location of the regulated entity. Tied together, the two sets provide a more detailed picture.\n\nnov_raw &lt;- read_csv(\"data_raw/20241028.csv\") |&gt; clean_names()\n\nRows: 65639 Columns: 21\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (18): Regulated Entity Number, Regulated Entity Name, Business Type, Phy...\ndbl  (3): Investigation Number, Notice of Violation ID, Total Violation Count\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nnov_raw |&gt; glimpse()\n\nRows: 65,639\nColumns: 21\n$ regulated_entity_number          &lt;chr&gt; \"RN100209931\", \"RN100209931\", \"RN1002…\n$ regulated_entity_name            &lt;chr&gt; \"COVESTRO INDUSTRIAL PARK BAYTOWN PLA…\n$ business_type                    &lt;chr&gt; \"INDUSTRIAL CHEMICAL MANUFACTURING PL…\n$ physical_location                &lt;chr&gt; \"8500 W BAY RD\", \"8500 W BAY RD\", NA,…\n$ physical_city                    &lt;chr&gt; \"BAYTOWN\", \"BAYTOWN\", NA, \"CROSBY\", \"…\n$ physical_state                   &lt;chr&gt; \"TX\", \"TX\", NA, \"TX\", \"TX\", \"TX\", \"TX…\n$ physical_zip_code                &lt;chr&gt; \"77523\", \"77523\", NA, \"77532\", \"77571…\n$ county                           &lt;chr&gt; \"CHAMBERS\", \"CHAMBERS\", \"WEBB\", \"HARR…\n$ investigation_number             &lt;dbl&gt; 1395926, 1956272, 1910546, 907867, 19…\n$ investigation_approved_date      &lt;chr&gt; \"May 10, 2017\", \"Feb 28, 2024\", \"Aug …\n$ nov_date                         &lt;chr&gt; \"May 11, 2017\", \"Feb 28, 2024\", \"Aug …\n$ coordinates_county_centroid      &lt;chr&gt; \"POINT (-94.72369894531248 29.7123136…\n$ tceq_region                      &lt;chr&gt; \"REGION 12 - HOUSTON\", \"REGION 12 - H…\n$ notice_of_violation_id           &lt;dbl&gt; 2.295461e+14, 4.613774e+14, 2.395373e…\n$ cat_a_violation_tracking_numbers &lt;chr&gt; NA, NA, NA, NA, \"862725\", NA, NA, NA,…\n$ cat_a_violation_citations        &lt;chr&gt; NA, NA, NA, NA, \"116.115(c); 382.085(…\n$ cat_b_violation_tracking_numbers &lt;chr&gt; NA, \"871474\", \"850936\", NA, NA, \"7273…\n$ cat_b_violation_citations        &lt;chr&gt; NA, \"111.111(a)(1)(B); 122.143(4); 38…\n$ cat_c_violation_tracking_numbers &lt;chr&gt; \"633665\", \"871471; 871479\", NA, \"4340…\n$ cat_c_violation_citations        &lt;chr&gt; \"116.115(c); 117.345(c); 122.143(4); …\n$ total_violation_count            &lt;dbl&gt; 1, 3, 1, 1, 1, 1, 4, 1, 2, 3, 1, 1, 1…\n\n\nI will adjust some of the columns to be character values like previously. I will also look at the summary here to see the date range.\n\nnov_clean &lt;- nov_raw |&gt;\n  mutate(investigation_approved_date = mdy(investigation_approved_date),\n         nov_date = mdy(nov_date),\n         investigation_number = as.character(investigation_number),\n         notice_of_violation_id = as.character(notice_of_violation_id)) |&gt;\n  filter(year(nov_date) != 3000) |&gt;\n  arrange(investigation_approved_date)\n\nsummary(nov_clean)\n\n regulated_entity_number regulated_entity_name business_type     \n Length:65635            Length:65635          Length:65635      \n Class :character        Class :character      Class :character  \n Mode  :character        Mode  :character      Mode  :character  \n                                                                 \n                                                                 \n                                                                 \n physical_location  physical_city      physical_state     physical_zip_code \n Length:65635       Length:65635       Length:65635       Length:65635      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n    county          investigation_number investigation_approved_date\n Length:65635       Length:65635         Min.   :2010-09-16         \n Class :character   Class :character     1st Qu.:2014-10-28         \n Mode  :character   Mode  :character     Median :2017-11-13         \n                                         Mean   :2017-11-24         \n                                         3rd Qu.:2021-01-11         \n                                         Max.   :2024-07-01         \n    nov_date          coordinates_county_centroid tceq_region       \n Min.   :2010-09-16   Length:65635                Length:65635      \n 1st Qu.:2014-08-27   Class :character            Class :character  \n Median :2017-07-27   Mode  :character            Mode  :character  \n Mean   :2017-09-24                                                 \n 3rd Qu.:2020-11-19                                                 \n Max.   :2024-07-19                                                 \n notice_of_violation_id cat_a_violation_tracking_numbers\n Length:65635           Length:65635                    \n Class :character       Class :character                \n Mode  :character       Mode  :character                \n                                                        \n                                                        \n                                                        \n cat_a_violation_citations cat_b_violation_tracking_numbers\n Length:65635              Length:65635                    \n Class :character          Class :character                \n Mode  :character          Mode  :character                \n                                                           \n                                                           \n                                                           \n cat_b_violation_citations cat_c_violation_tracking_numbers\n Length:65635              Length:65635                    \n Class :character          Class :character                \n Mode  :character          Mode  :character                \n                                                           \n                                                           \n                                                           \n cat_c_violation_citations total_violation_count\n Length:65635              Min.   : 1.000       \n Class :character          1st Qu.: 1.000       \n Mode  :character          Median : 1.000       \n                           Mean   : 2.433       \n                           3rd Qu.: 3.000       \n                           Max.   :73.000       \n\n\nThe latest date shows up as the year 3000. I will check whether this is a repeating error by filtering the original data for years after 2024.\n\nnov_date_check &lt;- nov_raw |&gt;\n  mutate(\n    nov_date = mdy(nov_date),\n    extracted_year = year(nov_date)) |&gt;\n  filter(extracted_year &gt; 2024)\n\nnov_date_check\n\n# A tibble: 4 × 22\n  regulated_entity_number regulated_entity_name business_type physical_location \n  &lt;chr&gt;                   &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;             \n1 RN100673813             VINCE HAGAN           &lt;NA&gt;          330 CLAY RD BLDG …\n2 RN106076573             PHILLIPS 66 STATION   &lt;NA&gt;          229 N HWY 259     \n3 RN105779458             OSSF 1749 US HWY 79 N &lt;NA&gt;          1749 US HIGHWAY 7…\n4 RN109272617             MJ GROCERY GARY TX    &lt;NA&gt;          4883 FM 999       \n# ℹ 18 more variables: physical_city &lt;chr&gt;, physical_state &lt;chr&gt;,\n#   physical_zip_code &lt;chr&gt;, county &lt;chr&gt;, investigation_number &lt;dbl&gt;,\n#   investigation_approved_date &lt;chr&gt;, nov_date &lt;date&gt;,\n#   coordinates_county_centroid &lt;chr&gt;, tceq_region &lt;chr&gt;,\n#   notice_of_violation_id &lt;dbl&gt;, cat_a_violation_tracking_numbers &lt;chr&gt;,\n#   cat_a_violation_citations &lt;chr&gt;, cat_b_violation_tracking_numbers &lt;chr&gt;,\n#   cat_b_violation_citations &lt;chr&gt;, cat_c_violation_tracking_numbers &lt;chr&gt;, …\n\n\nThere are four dates labeled with the year 3000, which needs to be followed up with a TCEQ information officer.\nTo see the actual latest date, I will edit the earlier to exclude the mismatched year (at least for now). The clean data set ranges from November 16, 2010 all the way to July 19, 2024. As with the citations data set, I want to have this one in a searchable table format for reference.\n\n#nov_clean |&gt; datatable()"
  },
  {
    "objectID": "01-cleaning.html#exporting-the-data",
    "href": "01-cleaning.html#exporting-the-data",
    "title": "Cleaning",
    "section": "Exporting the data",
    "text": "Exporting the data\nLast but not least, I will export the cleaned data in a native R format.\n\ncitations_clean |&gt; write_rds(\"data_processed/01-citations.rds\")\n\nnov_clean |&gt; write_rds(\"data_processed/01-nov.rds\")"
  },
  {
    "objectID": "99-draft.html",
    "href": "99-draft.html",
    "title": "99-draft",
    "section": "",
    "text": "A place to store previous chunks and discarded takeaways.\ncitations_clean |&gt; left_join(nov_clean_entity, join_by(notice_of_violation_id == notice_of_violation_id)) |&gt; filter(is.na(regulated_entity_name)) |&gt; summary(investigation_approved_date)\nListing out keywords based on similarities:\nindustry_keywords &lt;- list( “Oil & Gas Production” = c(“OIL”, “GAS”, “DRILLING”, “EXPLORATION”, “WELL”, “FIELD SERVICE”, “OIL FIELD”, “OIL WELL”), “Petroleum Refining and Chemical Manufacturing” = c(“REFIN”, “REFINERY”, “CHEMICAL”, “MANUFACTURING”, “PETROLEUM”), “Construction and Development” = c(“CONSTRUCTION”, “BUILDING”, “EXCAVATION”, “SITE”, “BRIDGE”, “CONCRETE”), “Waste Management and Disposal” = c(“WASTE”, “LANDFILL”, “RECYCLING”, “COMPOSTING”, “HAZARDOUS”, “DISPOSAL”), “Water Management” = c(“WATER”, “WASTEWATER”, “IRRIGATION”, “TREATMENT”, “PWS”), “Energy Generation” = c(“POWER”, “ELECTRIC”, “GENERATION”, “SOLAR”, “WIND”), “Retail” = c(“RETAIL”, “SHOP”, “STORE”), “Domestic Services” = c(“DOMESTIC”, “RESIDENTIAL”, “LAWN”, “LANDSCAPING”), “Fleet Services” = c(“FLEET”, “REFUELING”, “AIRCRAFT”), “Agriculture and Food Production” = c( “AGRICULTURE”, “FARM”, “CROP”, “FOOD”, “MEAT”, “DAIRY”, “EGG”, “SHRIMP”, “SEAFOOD”, “GRAIN”, “POULTRY”, “RESTAURANT” ), “Residential Parks and Campgrounds” = c(“HOME PARK”, “MOBILE HOME”, “RV PARK”, “TRAILER PARK”, “CAMP”), “Land Use” = c(“LAND”, “PROPERTY”, “CLEARING”, “TRACT”, “DEVELOPMENT”), “Public Services” = c(“GOVERNMENT”, “MUNICIPAL”, “UTILITY”, “PUBLIC”, “HOSPITAL”, “CORRECTION”) )\nNormalizing for capitalization, misspellings, and abbreviations, and handing NA values:\ncategorize_business_type &lt;- function(business_type) { if (is.na(business_type)) { return(“Other”) } business_type &lt;- toupper(business_type) business_type &lt;- str_replace_all(business_type, “LANSCAPING”, “LANDSCAPING”) business_type &lt;- str_replace_all(business_type, “RESTURANT”, “RESTAURANT”) for (industry in names(industry_keywords)) { if (any(str_detect(business_type, industry_keywords[[industry]]))) { return(industry) } } return(“Other”) }\nAnd applying the categorizations:\nindustry_count &lt;- nov_clean |&gt; mutate(categorized_industry = sapply(business_type, categorize_business_type) ) |&gt; group_by(categorized_industry) |&gt; summarize( total_violations = n()) |&gt; arrange(desc(total_violations))\nindustry_count\n|&gt; filter( investigation_approved_date &gt;= as.Date(“2010-09-16”) & violation_status_date &gt;= as.Date(“2010-09-16”) & compliance_due_date &gt;= as.Date(“2010-09-16”)\nA water utility in Midland received the most environmental violations in Texas since 2010, with 222 notices in total. Allegations toward the Warren Road Subdivision Water Supply include failures to report arsenic, nitrate, lead, and copper levels during the monitoring period, among other infractions.\nA chemical plant in Brazoria appears third with 667 notices. The Dow Texas Facility was cited for failing to prevent unauthorized emissions and flaring during an incident, neglecting to cap open-ended volatile organic compound (VOC) lines, inadequately documenting hazardous waste classification, and lacking proper back flow prevention at its waste water treatment plant, among other notices.\nThe condo complex in Leander (a specific apartment, in fact) faced notices for various infractions, including insufficient well capacity and, most recently, a failure to monitor water quality parameters.\nMeanwhile, the VFW post in Menchaca was cited for exceeding the maximum contaminant level for coliform and neglecting to collect E. coli samples following positive results.\nEven a church made it on the list. The Bee Creek United Methodist Church, making it to top five violators in Travis County, was cited for failure to monitor and/or report distribution disinfectant residuals.\n865475, 880706, 877372, 900174, 912465, 921135, 921136, 922514, 949101, 956410, 956539, 968221, 977193, 989269, 989424, 1060448, 1152748, 1197338, 1211219, 1211175, 1315386, 1400429, 1422597, 1422604, 1422610, 1422608, 1484776, 1484961, 1478896, 1489870, 1496981, 1552758, 1592969, 1603436, 1640007, 1632024, 1672546, 1825374, 1880556, 1869122, 1966450"
  }
]